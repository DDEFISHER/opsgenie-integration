task prepareSplunk(dependsOn: 'generateIntegration') {
    doLast {
        def destination = "${project.buildDir}/splunk"
        copy {
            from "${project.buildDir}/opsgenie-integration"
            into "${destination}/opsgenie-integration"
        }

        copy {
            from "${project.projectDir}/splunk/lamp"
            into "${destination}/opsgenie-integration/lamp"
        }

        copy {
            from "${project.projectDir}/splunk/splunkActionScripts"
            into "${destination}/splunkActionScripts"
        }

        copy {
            from configurations.splunk
            into "${destination}/opsgenie-integration/lamp/lib"
        }
    }
}

task packageSplunkZip(dependsOn: 'prepareSplunk', type: Zip) {
    from "${project.buildDir}/splunk"
    baseName = 'opsgenie-splunk'
}

task packageSplunk(dependsOn: 'packageSplunkZip')